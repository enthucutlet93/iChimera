# GRSuite
A collection of code written in Julia which numerically computes various objects of interest in GR, including geodesics, extreme-mass-ratio inspirals, and gravitational waveforms.

## Components ##

* **Geodesics**: code which numerically solves the geodesic equation in Kerr can be found in the <em>Kerr.jl</em> file, while code for computing geodesics in more general axisymmetric and stationary spacetimes can be found in <em>NumericalGeodesics.jl</em>. Code for solving the separated Hamilton-Jacobi geodesic equations in both Boyer-Lindquist (BL) time and Mino time can be found in <em>HamiltonJacobiEvolution.jl</em> and <em>MinoTimeEvolution.jl</em>, respecitvely.

* **Constants of motion**: mappings between the sets of parameters $\mathcal{I}=(E, L_{z}, Q)$ and $\mathcal{O}=(p, e, Î¸_\text{min})$ (in both directions) can be found in the  <em>Kerr.jl</em> file. In particular, we provide code which implements
  * The method presented in Ref. [1] for the mapping $\mathcal{I}\to\mathcal{O}$, and computing the fundamental frequencies with respect to proper time and BL time from the parameters $\mathcal{I}$.
  * The method presented in Ref. [3] for the mappings $\mathcal{I}\leftrightarrow\mathcal{O}$, and computing the fundamental frequencies with respect to Mino time and BL time from the parameters $\mathcal{I}$. Note that their method for computing the fundamental frequencies is essentially the same as that in Ref. [4].
  * The method presented in Ref. [5] for the mapping $\mathcal{O}\to\mathcal{I}$.

* **Numerical Kludge gravitational waveforms** the file <em>KludgeWaveforms.jl</em> contains code which computes the gravitational waveform for a particle on a bound orbit around a Kerr black hole, i.e., ignoring radiation-reaction effects, using the method described in Ref. [2]. We also provide code which computes these semi-relativistic waveforms for more general axisymmetric and stationary spacetimes.

* **EMRIs**: the file <em>SelfForce.jl</em> contains code which computes a fully-relativistic inspiral based on the model described in detail in Ref. [3], which treats the self-force locally and non-adiabtically. In this approach, one makes use of the method of osculating orbits, wherein one utilizes the fact that the radiation-reaction time scale is much larger than the orbital timescale. This allows one to treat the EMRI trajectory as comprised of many "small" piecewise geodesics which are tangent to the EMRI trajectory at different points. One then moves between successive geodesics by (locally) computing the self-force at the end of the previous one, using this to update the values of the contstans $\mathcal{I}$ and $\mathcal{O}$, and then computing the next geodesic with these updated parameters. See the [examples notebook](https://nbviewer.org/github/lennoxkeeble/GRSuite/blob/main/execution/execution_examples.ipynb) for code which compute EMRIs based on this method in addition to plotting the evolution of the constants of motion and the gravitational waveform.

* **Plotting**: the file <em>GRPlotLib.jl</em> contains useful code for making plots of trajectories, waveforms, and the effective potential. The functions are not at all robust, but serve to provide a starting point for some basic plots to interpret the solutions generated by the other modules in this package.  

## Dependencies ##

All the dependencies are located in the <em>dependencies.jl</em> file. Simply run <code> include("dependencies.jl")</code> to install all the necessary packages

## Limitations and known possible performance issues ##

* This code has only been tested on Mac OS.
* The main bottleneck in the runtime of this code is fitting the multipole moments, which are used to compute the self-force, to their fourier series expansion in either Mino time or BL time in order to reliably take high-order derivatives by differentiating the analytic expression of the fourier series (see Ref. [3] for futher detail). We also provide code which takes these derivatives numerically in Mino time, offering a significant (~20x) speedup in comparison to carrying out least-squares fits. In our limited testing so far, computing the inspiral using numerical differentiation in Mino time appears to be at least as accurate as with the fits, though tests for more points in the parameter space are to be carried out.

## Authors ##

- Lennox Keeble
- Alejandro Cardenas-Avendano

Last updated: 05.23.2024

## References ##
[1] Schmidt, W. Celestial mechanics in Kerr spacetime. [arXiv:gr-qc/0202090](https://arxiv.org/abs/gr-qc/0202090)

[2] Babak, S., et al. "Kludge" gravitational waveforms for a test-body orbiting a Kerr black hole. [arXiv:gr-qc/0607007v2](https://arxiv.org/abs/gr-qc/0607007v2)

[3] Sopuerta, C., & Yunes, N. New Kludge Scheme for the Construction of Approximate Waveforms for Extreme-Mass-Ratio Inspirals. [arXiv:1109.0572](https://arxiv.org/abs/1109.0572)

[4] Fujita, R., & Hikida, W. Analytical solutions of bound timelike geodesic orbits in Kerr spacetime. [arXiv:0906.1420v2](https://arxiv.org/abs/0906.1420)

[5] Hughes, S. A. Parameterizing black hole orbits for adiabatic inspiral. [arXiv:2401.09577v2](https://arxiv.org/abs/2401.09577)

## MIT License

Permission is hereby granted, free of charge, to any person obtaining a copy of this 
software and associated documentation files (the "Software"), to deal in the Software 
without restriction, including without limitation the rights to use, copy, modify, merge, 
publish, distribute, sublicense, and/or sell copies of the Software, and to permit 
persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies 
or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, 
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR 
PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE 
FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, 
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN 
THE SOFTWARE.
