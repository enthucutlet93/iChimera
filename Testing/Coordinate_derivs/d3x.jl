d3x(dx2::Vector{Float64}, dx::Vector{Float64}, x::Vector{Float64}, SinTheta::Float64, Sin2Theta::Float64, Sin3Theta::Float64, Sin4Theta::Float64, CosTheta::Float64, Cos2Theta::Float64, Cos3Theta::Float64, Cos4Theta::Float64, TanTheta::Float64, CscTheta::Float64, SecTheta::Float64, CotTheta::Float64, a::Float64) = [d3t(dx2, dx, x, SinTheta, Sin2Theta, Sin3Theta, Sin4Theta, CosTheta, Cos2Theta, Cos3Theta, Cos4Theta, TanTheta, CscTheta, SecTheta, CotTheta, a),
d3r(dx2, dx, x, SinTheta, Sin2Theta, Sin3Theta, Sin4Theta, CosTheta, Cos2Theta, Cos3Theta, Cos4Theta, TanTheta, CscTheta, SecTheta, CotTheta, a),
d3θ(dx2, dx, x, SinTheta, Sin2Theta, Sin3Theta, Sin4Theta, CosTheta, Cos2Theta, Cos3Theta, Cos4Theta, TanTheta, CscTheta, SecTheta, CotTheta, a),
d3ϕ(dx2, dx, x, SinTheta, Sin2Theta, Sin3Theta, Sin4Theta, CosTheta, Cos2Theta, Cos3Theta, Cos4Theta, TanTheta, CscTheta, SecTheta, CotTheta, a)]

d3t(dx2::Vector{Float64}, dx::Vector{Float64}, x::Vector{Float64}, SinTheta::Float64, Sin2Theta::Float64, Sin3Theta::Float64, Sin4Theta::Float64, CosTheta::Float64, Cos2Theta::Float64, Cos3Theta::Float64, Cos4Theta::Float64, TanTheta::Float64, CscTheta::Float64, SecTheta::Float64, CotTheta::Float64, a::Float64) = (-2.0*(-1.0 + x[2])*(a^2.0*CosTheta^2 + x[2]^2)*dx[2]*(2.0*a^2.0*x[2]*(a^2 + (-2.0 + x[2])*x[2])*Sin2Theta*dx[3]*(dx[1] - a*SinTheta^2.0*dx[4]) + dx[2]*(2.0*(a^2.0*CosTheta^2 - x[2]^2)*(a^2 + x[2]^2)*dx[1] + a*(-2.0*a^4.0*CosTheta^2 + a^2.0*(3 + Cos2Theta)*x[2]^2 + 6.0*x[2]^4)*SinTheta^2.0*dx[4])) - 2.0*(a^2 + (-2.0 + x[2])*x[2])*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3])*(2.0*a^2.0*x[2]*(a^2 + (-2.0 + x[2])*x[2])*Sin2Theta*dx[3]*(dx[1] - a*SinTheta^2.0*dx[4]) + dx[2]*(2.0*(a^2.0*CosTheta^2 - x[2]^2)*(a^2 + x[2]^2)*dx[1] + a*(-2.0*a^4.0*CosTheta^2 + a^2.0*(3 + Cos2Theta)*x[2]^2 + 6.0*x[2]^4)*SinTheta^2.0*dx[4])) + (a^2 + (-2.0 + x[2])*x[2])*(a^2.0*CosTheta^2 + x[2]^2)*(4.0*a^2.0*(-1.0 + x[2])*x[2]*Sin2Theta*dx[2]*dx[3]*(dx[1] - a*SinTheta^2.0*dx[4]) + 2.0*a^2.0*(a^2 + (-2.0 + x[2])*x[2])*Sin2Theta*dx[2]*dx[3]*(dx[1] - a*SinTheta^2.0*dx[4]) + 4.0*a^2.0*Cos2Theta*x[2]*(a^2 + (-2.0 + x[2])*x[2])*dx[3]^2.0*(dx[1] - a*SinTheta^2.0*dx[4]) + (2.0*(a^2.0*CosTheta^2 - x[2]^2)*(a^2 + x[2]^2)*dx[1] + a*(-2.0*a^4.0*CosTheta^2 + a^2.0*(3 + Cos2Theta)*x[2]^2 + 6.0*x[2]^4)*SinTheta^2.0*dx[4])*dx2[2] + 2.0*a^2.0*x[2]*(a^2 + (-2.0 + x[2])*x[2])*Sin2Theta*(dx[1] - a*SinTheta^2.0*dx[4])*dx2[3] + 2.0*a^2.0*x[2]*(a^2 + (-2.0 + x[2])*x[2])*Sin2Theta*dx[3]*(-(a*Sin2Theta*dx[3]*dx[4]) + dx2[1] - a*SinTheta^2.0*dx2[4]) + dx[2]*(-4.0*x[2]*(-(a^2.0*CosTheta^2) + x[2]^2)*dx[2]*dx[1] - 2.0*(a^2 + x[2]^2)*dx[1]*(2.0*x[2]*dx[2] + a^2.0*Sin2Theta*dx[3]) + 2.0*a*CosTheta*(-2.0*a^4.0*CosTheta^2 + a^2.0*(3 + Cos2Theta)*x[2]^2 + 6.0*x[2]^4)*SinTheta*dx[3]*dx[4] + a*SinTheta^2.0*(2.0*a^2.0*(3 + Cos2Theta)*x[2]*dx[2] + 24.0*x[2]^3.0*dx[2] + 2.0*a^4.0*Sin2Theta*dx[3] - 2.0*a^2.0*x[2]^2.0*Sin2Theta*dx[3])*dx[4] + 2.0*(a^2.0*CosTheta^2 - x[2]^2)*(a^2 + x[2]^2)*dx2[1] + a*(-2.0*a^4.0*CosTheta^2 + a^2.0*(3 + Cos2Theta)*x[2]^2 + 6.0*x[2]^4)*SinTheta^2.0*dx2[4])))/((a^2 + (-2.0 + x[2])*x[2])^2.0*(a^2.0*CosTheta^2 + x[2]^2)^3)

d3r(dx2::Vector{Float64}, dx::Vector{Float64}, x::Vector{Float64}, SinTheta::Float64, Sin2Theta::Float64, Sin3Theta::Float64, Sin4Theta::Float64, CosTheta::Float64, Cos2Theta::Float64, Cos3Theta::Float64, Cos4Theta::Float64, TanTheta::Float64, CscTheta::Float64, SecTheta::Float64, CotTheta::Float64, a::Float64) = (2.0*a^2.0*dx[2]*dx[3]^2)/(a^2.0*CosTheta^2 + x[2]^2) - (4.0*a^2.0*x[2]*SecTheta^2.0*TanTheta*dx[2]*dx[3]*(dx[2] + x[2]*TanTheta*dx[3]))/(a^2 + x[2]^2.0*SecTheta^2)^2 + dx[2]^2.0*(dx[2]/(a^2 + (-2.0 + x[2])*x[2]) - dx[2]/(a^2.0*CosTheta^2 + x[2]^2) - (2.0*(-1.0 + x[2])^2.0*dx[2])/(a^2 - 2.0*x[2] + x[2]^2)^2 + (x[2]*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3]))/(a^2.0*CosTheta^2 + x[2]^2)^2) + (2.0*(-1.0 + x[2])*dx[2]*((a^2.0*CosTheta^2 - x[2]^2)*dx[1]^2 + x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[3]^2 + 2.0*a*(-(a^2.0*CosTheta^2) + x[2]^2)*SinTheta^2.0*dx[1]*dx[4] + SinTheta^2.0*(x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*(a^2.0*CosTheta^2 - x[2]^2)*SinTheta^2)*dx[4]^2))/(a^2.0*CosTheta^2 + x[2]^2)^3 - (3.0*(a^2 + (-2.0 + x[2])*x[2])*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3])*((a^2.0*CosTheta^2 - x[2]^2)*dx[1]^2 + x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[3]^2 + 2.0*a*(-(a^2.0*CosTheta^2) + x[2]^2)*SinTheta^2.0*dx[1]*dx[4] + SinTheta^2.0*(x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*(a^2.0*CosTheta^2 - x[2]^2)*SinTheta^2)*dx[4]^2))/(a^2.0*CosTheta^2 + x[2]^2)^4 + 2.0*((-1.0 + x[2])/(a^2 + (-2.0 + x[2])*x[2]) - x[2]/(a^2.0*CosTheta^2 + x[2]^2))*dx[2]*dx2[2] + (2.0*a^2.0*TanTheta*dx[3]*dx2[2])/(a^2 + x[2]^2.0*SecTheta^2) + (2.0*a^2.0*TanTheta*dx[2]*dx2[3])/(a^2 + x[2]^2.0*SecTheta^2) + ((a^2 - 2.0*x[2] + x[2]^2)*(10.0*x[2]^4.0*dx[2]*(dx[3]^2 + SinTheta^2.0*dx[4]^2) + 2.0*x[2]^5.0*(dx[3]*(Sin2Theta*dx[4]^2 + 2.0*dx2[3]) + 2.0*SinTheta^2.0*dx[4]*dx2[4]) + 2.0*a^2.0*CosTheta*x[2]^3.0*(-4.0*SinTheta*dx[3]^3 + 2.0*dx[3]*((-SinTheta + Sin3Theta)*dx[4]^2 + 2.0*CosTheta*dx2[3]) + 4.0*CosTheta*SinTheta^2.0*dx[4]*dx2[4]) + x[2]^2.0*(3.0*a^2.0*dx[2]*(4.0*CosTheta^2.0*dx[3]^2 + Sin2Theta^2.0*dx[4]^2) + 4.0*(dx[1] - a*SinTheta^2.0*dx[4])*(a*Sin2Theta*dx[3]*dx[4] - dx2[1] + a*SinTheta^2.0*dx2[4])) + x[2]*(-4.0*dx[2]*(dx[1] - a*SinTheta^2.0*dx[4])^2 + a^4.0*CosTheta^3.0*(-8.0*SinTheta*dx[3]^3 + dx[3]*((-5.0*SinTheta + 3.0*Sin3Theta)*dx[4]^2 + 4.0*CosTheta*dx2[3]) + 4.0*CosTheta*SinTheta^2.0*dx[4]*dx2[4])) + a^2.0*(-2.0*Sin2Theta*dx[1]^2.0*dx[3] - dx[1]*(2.0*a*Sin4Theta*dx[3]*dx[4] - 4.0*CosTheta^2.0*dx2[1] + a*Sin2Theta^2.0*dx2[4]) + a*CosTheta*(2.0*a*CosTheta^3.0*dx[2]*(dx[3]^2 + SinTheta^2.0*dx[4]^2) + SinTheta^2.0*dx[4]*(a*(-SinTheta + 3.0*Sin3Theta)*dx[3]*dx[4] - 4.0*CosTheta*(dx2[1] - a*SinTheta^2.0*dx2[4]))))))/(2.0*(a^2.0*CosTheta^2 + x[2]^2)^3)

d3θ(dx2::Vector{Float64}, dx::Vector{Float64}, x::Vector{Float64}, SinTheta::Float64, Sin2Theta::Float64, Sin3Theta::Float64, Sin4Theta::Float64, CosTheta::Float64, Cos2Theta::Float64, Cos3Theta::Float64, Cos4Theta::Float64, TanTheta::Float64, CscTheta::Float64, SecTheta::Float64, CotTheta::Float64, a::Float64) = (-3.0*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3])*((-2.0*a^2.0*CosTheta*(a^2.0*CosTheta^2 + x[2]^2)^2.0*SinTheta*dx[2]^2)/(a^2 + (-2.0 + x[2])*x[2]) - 4.0*x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[2]*dx[3] + Sin2Theta*(2.0*x[2]*(a*dx[1] - (a^2 + x[2]^2)*dx[4])^2 + (a^2.0*CosTheta^2 + x[2]^2)^2.0*(a^2.0*dx[3]^2 + (a^2 + (-2.0 + x[2])*x[2])*dx[4]^2))) + 2.0*(a^2.0*CosTheta^2 + x[2]^2)*((2.0*a^2.0*CosTheta*(-1.0 + x[2])*(a^2.0*CosTheta^2 + x[2]^2)^2.0*SinTheta*dx[2]^3)/(a^2 - 2.0*x[2] + x[2]^2)^2 - 2.0*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[2]^2.0*dx[3] - (a^2.0*CosTheta^2.0*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[2]^2.0*dx[3])/(a^2 + (-2.0 + x[2])*x[2]) + (a^2.0*(a^2.0*CosTheta^2 + x[2]^2)^2.0*SinTheta^2.0*dx[2]^2.0*dx[3])/(a^2 + (-2.0 + x[2])*x[2]) - 8.0*x[2]*(a^2.0*CosTheta^2 + x[2]^2)*dx[2]*dx[3]*(x[2]*dx[2] - a^2.0*CosTheta*SinTheta*dx[3]) + (4.0*a^2.0*CosTheta*(a^2.0*CosTheta^2 + x[2]^2)*SinTheta*dx[2]^2.0*(-(x[2]*dx[2]) + a^2.0*CosTheta*SinTheta*dx[3]))/(a^2 - 2.0*x[2] + x[2]^2) + Cos2Theta*dx[3]*(2.0*x[2]*(a*dx[1] - (a^2 + x[2]^2)*dx[4])^2 + (a^2.0*CosTheta^2 + x[2]^2)^2.0*(a^2.0*dx[3]^2 + (a^2 + (-2.0 + x[2])*x[2])*dx[4]^2)) - (2.0*a^2.0*CosTheta*(a^2.0*CosTheta^2 + x[2]^2)^2.0*SinTheta*dx[2]*dx2[2])/(a^2 + (-2.0 + x[2])*x[2]) - 2.0*x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[3]*dx2[2] - 2.0*x[2]*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[2]*dx2[3] + Sin2Theta*(dx[2]*(a*dx[1] - (a^2 + x[2]^2)*dx[4])^2 + (a^2.0*CosTheta^2 + x[2]^2)*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3])*(a^2.0*dx[3]^2 + (a^2 + (-2.0 + x[2])*x[2])*dx[4]^2) + 2.0*x[2]*(a*dx[1] - (a^2 + x[2]^2)*dx[4])*(-2.0*x[2]*dx[2]*dx[4] + a*dx2[1] - (a^2 + x[2]^2)*dx2[4]) + (a^2.0*CosTheta^2 + x[2]^2)^2.0*((-1.0 + x[2])*dx[2]*dx[4]^2 + a^2.0*dx[3]*dx2[3] + (a^2 + (-2.0 + x[2])*x[2])*dx[4]*dx2[4]))))/(2.0*(a^2.0*CosTheta^2 + x[2]^2)^4)

d3ϕ(dx2::Vector{Float64}, dx::Vector{Float64}, x::Vector{Float64}, SinTheta::Float64, Sin2Theta::Float64, Sin3Theta::Float64, Sin4Theta::Float64, CosTheta::Float64, Cos2Theta::Float64, Cos3Theta::Float64, Cos4Theta::Float64, TanTheta::Float64, CscTheta::Float64, SecTheta::Float64, CotTheta::Float64, a::Float64) = (2.0*(-2.0*(-1.0 + x[2])*(a^2.0*CosTheta^2 + x[2]^2)*dx[2]*((a^2 + (-2.0 + x[2])*x[2])*dx[3]*(2.0*a*CotTheta*x[2]*dx[1] - (CotTheta*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*x[2]*Sin2Theta)*dx[4]) - (dx[2]*((-4.0*a^3.0*CosTheta^2 + 4.0*a*x[2]^2)*dx[1] + (4.0*a^4.0*CosTheta^4.0*x[2] - 2.0*a^2.0*(3 + Cos2Theta)*x[2]^2 + 8.0*a^2.0*CosTheta^2.0*x[2]^3 - 8.0*x[2]^4 + 4.0*x[2]^5 + a^4.0*Sin2Theta^2)*dx[4]))/4.) - 2.0*(a^2 + (-2.0 + x[2])*x[2])*(2.0*x[2]*dx[2] - a^2.0*Sin2Theta*dx[3])*((a^2 + (-2.0 + x[2])*x[2])*dx[3]*(2.0*a*CotTheta*x[2]*dx[1] - (CotTheta*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*x[2]*Sin2Theta)*dx[4]) - (dx[2]*((-4.0*a^3.0*CosTheta^2 + 4.0*a*x[2]^2)*dx[1] + (4.0*a^4.0*CosTheta^4.0*x[2] - 2.0*a^2.0*(3 + Cos2Theta)*x[2]^2 + 8.0*a^2.0*CosTheta^2.0*x[2]^3 - 8.0*x[2]^4 + 4.0*x[2]^5 + a^4.0*Sin2Theta^2)*dx[4]))/4.) + (a^2 + (-2.0 + x[2])*x[2])*(a^2.0*CosTheta^2 + x[2]^2)*(2.0*(-1.0 + x[2])*dx[2]*dx[3]*(2.0*a*CotTheta*x[2]*dx[1] - (CotTheta*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*x[2]*Sin2Theta)*dx[4]) - (((-4.0*a^3.0*CosTheta^2 + 4.0*a*x[2]^2)*dx[1] + (4.0*a^4.0*CosTheta^4.0*x[2] - 2.0*a^2.0*(3 + Cos2Theta)*x[2]^2 + 8.0*a^2.0*CosTheta^2.0*x[2]^3 - 8.0*x[2]^4 + 4.0*x[2]^5 + a^4.0*Sin2Theta^2)*dx[4])*dx2[2])/4. + (a^2 + (-2.0 + x[2])*x[2])*(2.0*a*CotTheta*x[2]*dx[1] - (CotTheta*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*x[2]*Sin2Theta)*dx[4])*dx2[3] + (a^2 + (-2.0 + x[2])*x[2])*dx[3]*(2.0*a*CotTheta*dx[2]*dx[1] - 2.0*a*CscTheta^2.0*x[2]*dx[1]*dx[3] - (a^2.0*Sin2Theta*dx[2] + 2.0*a^2.0*Cos2Theta*x[2]*dx[3] - CscTheta^2.0*(a^2.0*CosTheta^2 + x[2]^2)^2.0*dx[3] - 4.0*CotTheta*(a^2.0*CosTheta^2 + x[2]^2)*(-(x[2]*dx[2]) + a^2.0*CosTheta*SinTheta*dx[3]))*dx[4] + 2.0*a*CotTheta*x[2]*dx2[1] - (CotTheta*(a^2.0*CosTheta^2 + x[2]^2)^2 + a^2.0*x[2]*Sin2Theta)*dx2[4]) + (dx[2]*(-4.0*a*dx[1]*(2.0*x[2]*dx[2] + a^2.0*Sin2Theta*dx[3]) - 4.0*((a^4.0*CosTheta^4 - a^2.0*(3 + Cos2Theta)*x[2] + 6.0*a^2.0*CosTheta^2.0*x[2]^2 - 8.0*x[2]^3 + 5.0*x[2]^4)*dx[2] + a^2.0*(a^2.0*Cos2Theta - 2.0*a^2.0*CosTheta^2.0*x[2] + x[2]^2 - 2.0*x[2]^3)*Sin2Theta*dx[3])*dx[4] + 4.0*(a^3.0*CosTheta^2 - a*x[2]^2)*dx2[1] - (4.0*a^4.0*CosTheta^4.0*x[2] - 2.0*a^2.0*(3 + Cos2Theta)*x[2]^2 + 8.0*a^2.0*CosTheta^2.0*x[2]^3 - 8.0*x[2]^4 + 4.0*x[2]^5 + a^4.0*Sin2Theta^2)*dx2[4]))/4.)))/((a^2 + (-2.0 + x[2])*x[2])^2.0*(a^2.0*CosTheta^2 + x[2]^2)^3)