module Deriv2

d2r_dt(dx::AbstractArray, x::AbstractArray, a::Float64) = ((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 - x[1]^2))/(a^2*cos(x[2])^2 + x[1]^2)^3 - (2*(a^2*cos(x[2])^2 - x[1]^2)*(a^2 + x[1]^2)*dx[1]^2)/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)^2) - ((1 - x[1])/(a^2 + (-2 + x[1])*x[1]) + x[1]/(a^2*cos(x[2])^2 + x[1]^2))*dx[1]^2 - (2*a^2*x[1]*sin(2*x[2])*dx[1]*dx[2])/(a^2*cos(x[2])^2 + x[1]^2)^2 + (2*a^2*tan(x[2])*dx[1]*dx[2])/(a^2 + x[1]^2*sec(x[2])^2) + (x[1]*(a^2 + (-2 + x[1])*x[1])*dx[2]^2)/(a^2*cos(x[2])^2 + x[1]^2) - (2*a*(a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 - x[1]^2)*sin(x[2])^2*dx[3])/(a^2*cos(x[2])^2 + x[1]^2)^3 + ((2*a^5*cos(x[2])^2 - a^3*(3 + cos(2*x[2]))*x[1]^2 - 6*a*x[1]^4)*sin(x[2])^2*dx[1]^2*dx[3])/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)^2) + (4*a^3*cos(x[2])*x[1]*sin(x[2])^3*dx[1]*dx[2]*dx[3])/(a^2*cos(x[2])^2 + x[1]^2)^2 + ((a^2 + (-2 + x[1])*x[1])*sin(x[2])^2*(x[1]*(a^2*cos(x[2])^2 + x[1]^2)^2 + a^2*(a^2*cos(x[2])^2 - x[1]^2)*sin(x[2])^2)*dx[3]^2)/(a^2*cos(x[2])^2 + x[1]^2)^3

d2θ_dt(dx::AbstractArray, x::AbstractArray, a::Float64) = (a^2*x[1]*sin(2*x[2]))/(a^2*cos(x[2])^2 + x[1]^2)^3 - (a^2*cos(x[2])*sin(x[2])*dx[1]^2)/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)) - (2*(a^2*cos(x[2])^2 - x[1]^2)*(a^2 + x[1]^2)*dx[1]*dx[2])/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)^2) - (2*x[1]*dx[1]*dx[2])/(a^2*cos(x[2])^2 + x[1]^2) - (2*a^2*x[1]*sin(2*x[2])*dx[2]^2)/(a^2*cos(x[2])^2 + x[1]^2)^2 + (a^2*tan(x[2])*dx[2]^2)/(a^2 + x[1]^2*sec(x[2])^2) - (2*a*x[1]*(a^2 + x[1]^2)*sin(2*x[2])*dx[3])/(a^2*cos(x[2])^2 + x[1]^2)^3 + ((2*a^5*cos(x[2])^2 - a^3*(3 + cos(2*x[2]))*x[1]^2 - 6*a*x[1]^4)*sin(x[2])^2*dx[1]*dx[2]*dx[3])/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)^2) + (4*a^3*cos(x[2])*x[1]*sin(x[2])^3*dx[2]^2*dx[3])/(a^2*cos(x[2])^2 + x[1]^2)^2 + (cos(x[2])*sin(x[2])*((a^2 + x[1]^2)*(a^2*cos(x[2])^2 + x[1]^2)^2 + a^2*x[1]*(a^2*(3 + cos(2*x[2])) + 4*x[1]^2)*sin(x[2])^2)*dx[3]^2)/(a^2*cos(x[2])^2 + x[1]^2)^3

d2ϕ_dt(dx::AbstractArray, x::AbstractArray, a::Float64) = (dx[1]*(2*a^3*cos(x[2])^2 - 2*a*x[1]^2 - 2*(a^4*cos(x[2])^4*x[1] - 2*a^2*x[1]^2 + 2*a^2*cos(x[2])^2*x[1]^3 - 3*x[1]^4 + x[1]^5 + a^4*cos(x[2])^2*(1 + sin(x[2])^2))*dx[3] + a*(2*a^4*cos(x[2])^2 - a^2*(3 + cos(2*x[2]))*x[1]^2 - 6*x[1]^4)*sin(x[2])^2*dx[3]^2) + 2*(a^2 + (-2 + x[1])*x[1])*dx[2]*(2*a*cot(x[2])*x[1] - (cot(x[2])*(a^2*cos(x[2])^2 + x[1]^2)^2 + 2*a^2*x[1]*sin(2*x[2]))*dx[3] + 2*a^3*cos(x[2])*x[1]*sin(x[2])^3*dx[3]^2))/((a^2 + (-2 + x[1])*x[1])*(a^2*cos(x[2])^2 + x[1]^2)^2)

end